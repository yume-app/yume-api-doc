openapi: 3.0.0
info:
  version: '1.0'
  title: YUME API
  description: >
    # Introduction

    Fast, secure tunnels to your internal networks. [Webhook
    Relay](https://webhookrelay.com) allows you to expose your localhost 

    or any other server in private network to the public internet without
    configuring port forwarding 

    or firewalls. 

    This API is documented in **Swagger format**. Webhook Relay allows to
    dynamically configure your tunnels and webhook forwarding.
        
    # Available authentication methods

    Webhook Relay offers three forms of authentication:
      - **Basic Auth** - only available for non-OAuth accounts. Use your username and password.
      - **API Key** - available for all accounts, token pairs can be generated [here](https://my.webhookrelay.com/tokens)
      - **JWT** - mainly used by the [admin dashboard](https://my.webhookrelay.com) with a 'Authorization Bearer: token' 
  termsOfService: 'https://webhookrelay.com/tos/'
  contact:
    email: support@webhookrelay.com
externalDocs:
  description: Find out more in the official documentation.
  url: 'https://yume-app.github.io/yume-api-doc/'
tags:
  - name: Users
    description: User management calls 
  - name: Providers
    description: >-
  - name: Requests
    description: >-
  - name: Rating
    description: >-
  - name: Addresses
    description: >-
  - name: Cuisines
    description: EndPoint to obtain information about cuisines/chef skills
  - name: Credit Cards
    description: EndPoint to obtain payment information


x-tagGroups:
  - name: Yume
    tags:
      - Users
      - Providers
      - Requests
      - Rating
      - Addresses
      - Cuisines
      - Credit Cards

paths:
  
  /users:
    get:
      tags:
        - Users
      summary: List All Users
      responses:
        '200':
          description: Successfull Response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/User'
    post:
      tags:
        - Users
      summary: Create a New User
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserCreateRequest'
      responses:
        '201':
          description: Successfull Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '400':
          description: Invalid create user request supplied
      
  /users/{userID}/:
    parameters:
      - name: userID
        in: path
        description: ID of user
        required: true
        schema:
          type: integer
    get:
      tags:
        - Users
      summary: Get User Details
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '404':
          description: User not found
    put:
      tags:
        - Users
      summary: Update User Details
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserUpdateRequest'
      responses:
        '200':
          description: Successfull Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '400':
          description: Invalid update user request supplied

  /providers:
    get:
      tags:
        - Providers
      summary: List All Providers
      responses:
        '200':
          description: Successfull Response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Provider'
    post:
      tags:
        - Providers
      summary: Create a New Providers
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProviderCreateRequest'
      responses:
        '201':
          description: Successfull Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Provider'
        '400':
          description: Invalid create user request supplied

  /providers/{providerID}:
    parameters:
      - name: providerID
        in: path
        description: ID of provider
        required: true
        schema:
          type: integer
    get:
      tags:
        - Providers
      summary: Get Provider Details
      responses:
        '200':
          description: Successfull Response
          content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ProviderDetails'
    put:
      tags:
        - Providers
      summary: Update Provider Details
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProviderUpdateRequest'
      responses:
        '200':
          description: Successfull Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Provider'
        '400':
          description: Invalid update provider request supplied
    delete:
      tags:
        - Providers
      summary: Delete Provider
      responses:
        '200':
          description: Successful Response
        '404':
          description: Provider not found

  /users/{userID}/rating:
    parameters:
      - name: userID
        in: path
        description: ID of user
        required: true
        schema:
          type: integer
    get:
        tags:
          - Rating
        summary: Get User Rating
        responses:
          '200':
            description: Successful Response
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/UserRating'
          '404':
            description: User not found
    post:
      tags:
        - Rating
      summary: Rate a Provider
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RateProviderRequest'
      responses:
        '201':
          description: Successfull Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProviderRating'
        '400':
          description: Invalid rating request supplied
    put:
      tags:
        - Rating
      summary: Update Provider Rating
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RateProviderRequest'
      responses:
        '200':
          description: Successfull Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProviderRating'
        '400':
          description: Invalid update rating request supplied

  /providers/{providerID}/rating:
    parameters:
      - name: providerID
        in: path
        description: ID of provider
        required: true
        schema:
          type: integer
    get:
      tags:
        - Rating
      summary: Get Provider Rating
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProviderRating'
        '404':
          description: Provider not found
    post:
      tags:
        - Rating
      summary: Rate a User
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RateUserRequest'
      responses:
        '201':
          description: Successfull Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserRating'
        '400':
          description: Invalid rating request supplied
    put:
      tags:
        - Rating
      summary: Update User Rating
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RateUserRequest'
      responses:
        '200':
          description: Successfull Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserRating'
        '400':
          description: Invalid update rating request supplied
  
  /users/{userID}/addresses:
    parameters:
      - name: userID
        in: path
        description: User ID
        required: true
        schema:
          type: integer
    get:
      tags:
        - Addresses
      summary: Lists User Addresses
      responses:
        '200':
          description: Successfull Response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UserAddress'
    post:
      tags:
        - Addresses
      summary: Create a User Address
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateUserAddressRequest'
      responses:
        '201':
          description: Successfull Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserAddress'
        '400':
          description: Invalid create user address request supplied

  /users/{userID}/addresses/{addressID}/:
    parameters:
      - name: userID
        in: path
        description: User ID
        required: true
        schema:
          type: integer
      - name: addressID
        in: path
        description: Address ID
        required: true
        schema:
          type: integer
    put:
      tags:
        - Addresses
      summary: Update User Address
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserAddressRequest'
      responses:
        '200':
          description: Successfull Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserAddress'
        '400':
          description: Invalid update user address request supplied
    delete:
      tags:
        - Addresses
      summary: Delete User Address
      responses:
        '200':
          description: Successful Response
        '404':
          description: User Address not found
                
  /providers/{providerID}/addresses:
    parameters:
      - name: providerID
        in: path
        description: Provider ID
        required: true
        schema:
          type: integer
    get:
      tags:
        - Addresses
      summary: Lists Provider Addresses
      responses:
        '200':
          description: Successfull Response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProviderAddress'
    post:
      tags:
        - Addresses
      summary: Create a Provider Address
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateProviderAddressRequest'
      responses:
        '201':
          description: Successfull Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProviderAddress'
        '400':
          description: Invalid create provider address request supplied
    
  /providers/{userID}/addresses/{addressID}/:
    parameters:
      - name: providerID
        in: path
        description: Provider ID
        required: true
        schema:
          type: integer
      - name: addressID
        in: path
        description: Address ID
        required: true
        schema:
          type: integer
    put:
      tags:
        - Addresses
      summary: Update Provider Address
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateProviderAddressRequest'
      responses:
        '200':
          description: Successfull Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProviderAddress'
        '400':
          description: Invalid update provider address request supplied
    delete:
      tags:
        - Addresses
      summary: Delete Provider Address
      responses:
        '200':
          description: Successful Response
        '404':
          description: Provider Address not found
  
  /cuisines:
    get:
      tags:
        - Cuisines
      summary: List All Cuisine Skills
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ArrayOfCuisines'
    post:
      tags:
        - Cuisines
      summary: Add a new cuisine
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
              example:   # Sample object
                name: Japanese
      responses:
        '201':
          description: Successfull Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Cuisine'
        '400':
          description: Invalid create cuisine request supplied 
        # CREATE NEW ERROR FOR DUPLICATED CUISINES ### TODO

  /providers/{providerID}/cuisines:
    parameters:
        - name: providerID
          in: path
          description: Provider ID
          required: true
          schema:
            type: integer
    get:
      tags:
        - Cuisines
      summary: Lists Provider Skills
      responses:
        '200':
          description: Successfull Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ArrayOfCuisines'
    post:
      tags:
        - Cuisines
      summary: Associate a provider with a certain skill
      requestBody:
        required: true
        content:
          application/json:
            schema:
              oneOf:
                - type: integer
                  example: 5
                - type: string
                  example: Indian
      responses:
        '201':
          description: Successfull Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Cuisine'
        '400':
          description: Invalid create provider skill request supplied

  /cards/{userID}:
    parameters:
        - name: userID
          in: path
          description: User ID
          required: true
          schema:
            type: integer
    get:
      tags:
        - Credit Cards
      summary: Get active credit card token
      responses:
        '200':
          description: Successfull Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Token'
    post:
      tags:
        - Credit Cards
      summary: Associate a credit card to an user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreditCard'
      responses:
        '201':
          description: Successfull Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Token'
        '400':
          description: Invalid credit card supplied
        
    

  /cards/{userID}/{token}:
    parameters:
        - name: userID
          in: path
          description: User ID
          required: true
          schema:
            type: integer
        - name: token
          in: path
          description: Token to the card to be deleted
          required: true
          schema:
            type: string

    delete:
      tags:
        - Credit Cards
      summary: Delete a secundary credit card. It only delets if there's another credit card
      responses:
        '200':
          description: Successfull Response

  /users/{userID}/requests:
    parameters:
      - name: userID
        in: path
        description: User ID
        required: true
        schema:
          type: integer
    get:
      tags:
        - Requests
      summary: Get User's Requests
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                state:
                  type: string
            example:
              state: 'closed'
      responses:
        '200':
          description: Successfull Response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Request'
        '400':
          description:  Invalid get user requests supplied
    post:
      tags:
        - Requests
      summary: Create Request
      requestBody:
        required: true
        content:
          application/json:
            schema:
               $ref: '#/components/schemas/CreateRequest'
      responses:
        '201':
          description: Successfull Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Request'
        '400':
          description: Invalid create request supllied
  
  /users/{userID}/requests/{requestID}/:
    parameters:
      - name: userID
        in: path
        description: User ID
        required: true
        schema:
          type: integer
      - name: requestID
        in: path
        description: Request ID
        required: true
        schema:
          type: integer

    get:
      tags:
        - Requests
      summary: Get Request Details
      responses:
        '200':
          description: Successfull Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Request'
        '404':
           description: Request not found
    
    put:
      tags:
        - Requests
      summary: Update Request
      requestBody:
        required: true
        content:
          application/json:
            schema:
               $ref: '#/components/schemas/UpdateRequest'
      responses:
        '200':
          description: Successfull Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Request'
        '400':
          description: Invalid update request supllied

  /providers/{providerID}/requests:
    parameters:
      - name: providerID
        in: path
        description: User ID
        required: true
        schema:
          type: integer
      - name: requestID
        in: path
        description: Request ID
        required: true
        schema:
          type: integer
    get:
      tags:
        - Requests
      summary: Get Provider's Requests
      responses:
        '200':
          description: Successfull Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Request'
        '404':
          description: Request not found
    
  


               
      

        



servers:
  - url: 'https://yume-app.github.io/yume-api-doc/'



components:
  schemas:
    User:
      title: User
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        birthday:
          type: integer
        email:
          type: string
        mobile:
          type: integer
        photo:
          type: string
        password:
          type: string
      example:
        id: 1
        name: 'John'
        birthday: 634780800
        email: 'john@potatoes.a.com'
        mobile: 143532322
        photo: 'localhost/john_picture.png'
        password: '*****'

    UserCreateRequest:
      title: User Create Request
      type: object
      properties:
        name:
          type: string
        birthday:
          type: integer
        email:
          type: string
        mobile:
          type: integer
        photo:
          type: string
        password:
          type: string
      required:
        - name
        - birthday
        - email
        - mobile
        - password
      example:
        name: 'John'
        birthday: 634780800
        email: 'john@potatoes.a.com'
        mobile: 143532322
        photo: 'localhost/john_picture.png'
        password: '*****'

    UserUpdateRequest:
      title: User Update Request
      type: object
      properties:
        name:
          type: string
        birthday:
          type: integer
        email:
          type: string
        mobile:
          type: integer
        photo:
          type: string
        password:
          type: string
      example:
        name: 'John'

    Provider:
      title: Provider
      type: object
      properties:
        id:
          type: integer
        user:
          type: integer
        name:
          type: string
        photo:
          type: string
      example:
        id: 1
        user: 1
        name: 'John'
        photo: 'localhost/john_picture.png'

    ProviderDetails:
      title: Provider Details
      type: object
      properties:
        id:
          type: integer
        user:
          type: integer
        name:
          type: string
        photo:
          type: string
        address:
          type: object
          $ref: '#/components/schemas/Address'
        price:
          type: decimal
        cuisines:
          type: array
          items:
            $ref: '#/components/schemas/Cuisine'
        equipments:
          type: array
          items:
            $ref: '#/components/schemas/Equipment'
        availability:
          type: array
          items:
            $ref: '#/components/schemas/Availability'
      example:
        id: 1
        user: 1
        name: 'John'
        photo: 'localhost/john_picture.png'
        address:
          id: 30
          country: Portugal
          city: Lisbon
          lat: 38.70767862
          lng: -9.13660973
        price: 7.5
        cuisines:
          [
            {
              id: 1,
              type: "Italiano",
              price: 15
            },
            {
              id: 2,
              type: "Chinês",
              price: 17.5
            }
          ]
        equipments:
          [
            {
              id: 1,
              price: 2.5,
              name: "Tacho"
            },
            {
              id: 2,
              price: 4,
              name: "Grill"
            }
          ]
        availability:
          [
            {
              id: 1,
              start: 2019-07-22T17:30:00Z,
              end: 2019-07-22T19:00:00Z,
              weekday: "Monday",
            },
            {
              id: 2,
              start: 2019-08-09T10:00:00Z,
              end: 2019-08-09T21:30:00Z,
              weekday: "Friday",
            }
          ]

    ProviderCreateRequest:
      title: Provider Create Request
      type: object
      properties:
        user:
          type: integer
        name:
          type: string
        photo:
          type: string
      required:
        - user
        - name
        - photo
      example:
        user: 1
        name: 'John'
        photo: 'localhost/john_picture.png'

    ProviderUpdateRequest:
      title: Provider Update Request
      type: object
      properties:
        user:
          type: integer
        name:
          type: string
        photo:
          type: string
      example:
        user: 1
        name: 'John'
        photo: 'localhost/john_picture.png'

    UserRating:
      title: UserRating
      type: object
      properties:
        user:
          type: integer
        rating:
          type: integer
        voters:
          type: integer
      example:
        user: 1
        rating: 3
        voters: 21
    
    ProviderRating:
      title: ProviderRating
      type: object
      properties:
        provider:
          type: integer
        rating:
          type: integer
        voters:
          type: integer
      example:
        provider: 1
        rating: 3
        voters: 21

    RateProviderRequest:
      title: RateProviderRequest
      type: object
      properties:
        provider:
          type: integer
        rating:
          type: integer
      required:
        - provider
        - rating
      example:
        provider: 1
        rating: 4

    RateUserRequest:
      title: RateUserRequest
      type: object
      properties:
        user:
          type: integer
        rating:
          type: integer
      required:
        - user
        - rating
      example:
        user: 2
        rating: 1

    Address:
      title: Address
      type: object
      properties:
        id:
          type: integer
        country:
          type: string
        city:
          type: string
        lat:
          type: double
        lng:
          type: double 
      example:
        id: 30
        country: Portugal
        city: Lisbon
        lat: 38.70767862
        lng: -9.13660973

    UserAddress:
      title: User Address
      type: object
      properties:
        id:
          type: integer
        user:
          type: integer
        local_address:
          type: string
        address:
          type: object
          $ref: '#/components/schemas/Address'
      example:
        id: 2
        user: 1
        local_address: Praça do Comércio, 1100-148 Lisboa
        address:
          id: 30
          country: Portugal
          city: Lisbon
          lat: 38.70767862
          lng: -9.13660973

    ProviderAddress:
      title: Provider Address
      type: object
      properties:
        id:
          type: integer
        provider:
          type: integer
        state:
          type: boolean
        address:
          type: object
          $ref: '#/components/schemas/Address'
      example:
        id: 3
        provider: 3
        state: true
        address:
          id: 30
          country: Portugal
          city: Lisbon
          lat: 38.70767862
          lng: -9.13660973

    CreateUserAddressRequest:
      title: Create User Address Request
      type: object
      properties:
        local_address:
          type: string
        country:
          type: string
        city:
          type: string
        lat:
          type: double
        lng:
          type: double
      required:
        - local_address
        - country
        - city
      example:
        local_address: "Praça do Comércio, 1100-148 Lisboa"
        country: "Portugal"
        city: "Lisbon"
        lat: 38.70767862
        lng: -9.13660973

    CreateProviderAddressRequest:
      title: Create Provider Address Request
      type: object
      properties:
        state:
          type: boolean
        country:
          type: string
        city:
          type: string
        lat:
          type: double
        lng:
          type: double
      required:
        - state
        - country
        - city
      example:
        state: true
        country: "Portugal"
        city: "Lisbon"
        lat: 38.70767862
        lng: -9.13660973
  
    UpdateUserAddressRequest:
      title: Update User Address Request
      type: object
      properties:
        local_address:
          type: string
        country:
          type: string
        city:
          type: string
        lat:
          type: double
        lng:
          type: double
      example:
        local_address: "Praça do Comércio, 1100-148 Lisboa"

    UpdateProviderAddressRequest:
      title: Update Provider Address Request
      type: object
      properties:
        state:
          type: boolean
        country:
          type: string
        city:
          type: string
        lat:
          type: double
        lng:
          type: double
      example:
        state: true

#CUISINES
    ArrayOfCuisines:
      type: array
      items:
        type: object
        properties:
          id:
            type: integer
          name:
            type: string
      example:
        - id: 1
          name: Portuguese
        - id: 2
          name: Japanese

    Cuisine:
      title: Cuisine
      type: object
      properties:
        id:
          type: integer
        type:
          type: string
      example:
        id: 2
        type: 'Chinese'


#EQUIPMENT
    Equipment:
      title: Equipment
      type: object
      properties:
        id:
          type: integer
        price:
          type: decimal
        name:
          type: string

    Availability:
      title: Availability
      type: object
      properties:
        id:
          type: integer
        start:
          type: date-time
        end:
          type: date-time
        weekday:
          type: string

    Request:
      title: Request
      type: object
      properties:
        id:
          type: integer
        user:
          type: integer
        provider:
          type: integer
        startDate:
          type: string
          format: date-time
        finishDate:
          type: string
          format: date-time
        price:
          type: number
          format: float
          minimum: 0.0
        location:
          type: object
          $ref: '#/components/schemas/UserAddress'
        status:
          type: string
        equipment:
          type: array
          items:
            $ref: '#/components/schemas/Equipment'
        cuisine:
          type: array
          items:
            $ref: '#/components/schemas/Cuisine'
      example:
        id: 1
        user: 2
        provider: 2
        startDate: "2019-07-22T17:30:00Z"
        endDate: "2019-07-22T22:30:00Z"
        price: 50.5
        location:  
          id: 2
          user: 1
          local_address: Praça do Comércio, 1100-148 Lisboa
          address:
            id: 30
            country: Portugal
            city: Lisbon
            lat: 38.70767862
            lng: -9.13660973
          status: "closed"
          equipment:
              - id: 1
                name: 'Grill'
                price: 5.0
              - id: 2
                name: 'Citrus Juicer'
                price: 1.0
          cuisine:
            items:
              - id: 2
                type: 'Chinese'

    CreateRequest:
      title: Create Request
      type: object
      properties:
        provider:
          type: integer
        startDate:
          type: string
          format: date-time
        finishDate:
          type: string
          format: date-time
        price:
          type: number
          format: float
          minimum: 0.0
        location:
          type: integer
        equipment:
          type: array
          items:
            type: integer
        cuisine:
          type: array
          items:
            type: integer
      required:
        - provider
        - startDate
        - finishDate
        - price
        - location
        - equipment
        - cuisine
      example:
        provider: 2
        startDate: "2019-07-22T17:30:00Z"
        endDate: "2019-07-22T22:30:00Z"
        price: 50.5
        location: 2 
        equipment:
          - 1
          - 2
        cuisine:
          - 2

    UpdateRequest:
      title: Update Request
      type: object
      properties:
        provider:
          type: integer
        startDate:
          type: string
          format: date-time
        finishDate:
          type: string
          format: date-time
        price:
          type: number
          format: float
          minimum: 0.0
        location:
          type: integer
        equipment:
          type: array
          items:
            type: integer
        cuisine:
          type: array
          items:
            type: integer
      example:
        location: 2 


#CREDIT CARDS
    CreditCard:
      title: Credit Card
      type: object
      properties:
        number:
          type: integer
        expiration:
          type: string
        ccv:
          type: integer
        cardHolder:
          type: string
      example:
        number: 123456789
        expiration: '06/22'
        ccv: 562
        cardHolder: 'John'

    Token:
      title: Token
      type: string
      example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9'


             
  

      
